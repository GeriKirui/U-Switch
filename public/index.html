<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>U-Switch</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link href="https://fonts.googleapis.com/css?family=Pacifico" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <!-- <link rel="stylesheet" type="text/css" href="css/style.css"> -->
    <!-- <script defer src="./index.js"></script> -->
</head>

<body style="overflow:hidden;">
    <h1> U-Switch </h1>
    <div class="buttons">
        <div type="button" id="toggleOn" onclick="sendData(1)">Toggle On</div>
        <div type="button" id="toggleOff" onclick="sendData(0)">Toggle Off</div>
        <div type="button" id="getStatus" onclick="getData()">Update status</div>
    </div>

    <div class="info">
        <h2> Switch Status </h2>
        <span id="switchInfo">
            <span id="switchStatus"></span>
        </span>
    </div>
    <!-- <input type="checkbox" id="toggleSwitch" onclick="func()"/><br> -->
    <script>
        let sendData = (state) => {
            let data = { state };

            const options = {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            };

            fetch('/api', options);
            getData();
        };

        async function getData() {

            const response = await fetch('/api');
            const data = await response.json();

            const state = document.getElementById("switchStatus");
            if(data == 1){state.textContent = "ON";}
            if(data == 0){state.textContent = "OFF";}
            const now = new Date().toLocaleString();
            state.textContent = state.textContent + " (Last updated at " + now +")";
        }
    </script>
    </div>
</body>

</html>