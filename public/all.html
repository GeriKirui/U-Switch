<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>
  <body>
      <h1>
      </h1>
      <script>
          getData();
          
          async function getData(){
            const response = await fetch('/api');
            const data = await response.json();
            
            const root = document.createElement('div');
            const state = document.createElement('div');
            const date = document.createElement('div');

            let maxIndex = (data) =>{
              let maxTime = 0;
              let index = 0;
              
              for(let i = 0; i < data.length; i++){
                if(data[i].timestamp > maxTime){
                  maxTime = data[i].timestamp;
                  index = i;
                }
              }
              return index;
              }

            item = data[maxIndex(data)];

            state.textContent = `${item.state}`;
            date.textContent = `${item.timestamp}`;
            // const dateString = new Date(item.timestamp).toLocaleString();
            // date.textContent = dateString;

            root.append(state);
            document.body.append(root);


            // for(item of data){
            //     const root = document.createElement('div');
            //     const state = document.createElement('div');
            //     const date = document.createElement('div');

            //     state.textContent = `${item.state}`;
            //     const dateString = new Date(item.timestamp).toLocaleString();
            //     date.textContent = dateString;

            //     root.append(state, date);
            //     document.body.append(root);

            // }
            // console.log(data);
          }
      </script>
  </body>
</html>